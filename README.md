# Darts Score Board 🎯

## 概要

文化祭などのイベントで使うために作られた、投影向けのダーツ用スコアボードです。来場者のスコアを入力してプロジェクターで投影し、演出（ガチャ、祝福演出、効果音）で場を盛り上げます。

このリポジトリは小規模な React + Vite アプリで、ローカルで実行することもデプロイすることもできます。

![alt text](/README_src/image-10.png)

## 主な追加／変更点（最新版）

- プレミアム機能: プレイヤー追加時に「プレミアム/スタンダード」を選択できる豪華なスイッチを追加しました。スイッチは視覚エフェクトと音でフィードバックします。
- ガチャ演出: スコアとプレミアムフラグに応じて表示する動画が切り替わります（ローカルの動画をバンドルして使用）。
- 祝福演出: ガチャの後にトップ3入りした場合、ファンファーレ音と共に順位（例: 2位）が表示されます。
- 効果音: プレミアムトグル（`premium.mp3`）、スコア追加（`score-add.mp3`）、ファンファーレ（`fanfare.mp3`）などを追加しました。
- UX: 「追加」を押すと必ずスイッチが STANDARD に戻るようにし、重複追加時でもプレミアムフラグが新しい状態で反映されるよう修正しました。

## 動作ルール（ガチャの動画選定）

- 非プレミアム:
  - score < 90 -> b.mp4
  - 90 <= score < 140 -> a.mp4
  - score >= 140 -> s.mp4
- プレミアム:
  - score < 120 -> a.mp4
  - score >= 120 -> s.mp4

ガチャは「追加」ボタンで必ず表示されます。ガチャが終わると、もし追加によってトップ3入りしたら祝福演出が鳴ります。

## ファイル配置（重要）

- 動画は `src/assets/videos/` に `a.mp4`, `b.mp4`, `s.mp4` を配置しています。Vite で確実に読み込むため、コード内で import して利用する形にしています。
- 効果音は `src/assets/sounds/` に配置しています（`score-add.mp3`, `premium.mp3`, `fanfare.mp3`, `dart-hit.mp3` など）。

もしカスタム動画を利用したい場合は、`src/assets/videos/` にファイルを置くか、GachaModal の import 部分を別の URL に差し替えてください。

## 開発（ローカルで動かす）

前提:

- Node.js (推奨 LTS)
- npm

セットアップ:

```powershell
git clone https://github.com/kinn00kinn/darts-score-board2.git
cd darts-score-board2
npm install
```

開発サーバ起動:

```powershell
npm run dev
```

ブラウザで指示された URL（通常は http://localhost:5173 ）を開いてください。

Lint:

```powershell
npm run lint
```

## 主要な操作方法（短く）

- 名前入力欄に名前を入れて `追加` を押すと、そのプレイヤーが追加（または既存プレイヤーのスコア加算）され、ガチャ演出が表示されます。
- プレミアムスイッチは名前入力の左にあります。ON/OFF 切替で `premium.mp3` が再生されます。追加を押すと自動で STANDARD に戻ります。
- ガチャ終了後、トップ3 に入った場合は `fanfare.mp3` が鳴り、`CelebrationOverlay` が順位を表示します。

## トラブルシューティング

- 動画が再生されない場合
  - ブラウザの Console（DevTools）でエラーを確認してください（404, CORS, 再生ポリシーなど）。
  - ローカル動画を使う場合は `src/assets/videos/a.mp4` 等が存在することを確認してください。プロジェクトはこれらを import して使用します。
  - 自動再生がブロックされる場合があります。Gacha は基本的にミュート再生を行いますが、ブラウザによってはユーザー操作が必要な場合があります。その場合は一度クリックなどの操作で再生を許可してください。

- 音が鳴らない場合
  - ブラウザの音量やタブのミュート設定を確認してください。
  - 自動再生ポリシーにより最初の再生がブロックされることがあります。ユーザーの操作（クリック）で明示的に再生するフローにすると確実です。

## 変更履歴（簡易）

- v1.0 — ベース機能（スコア管理、Undo/Reset、Leaderboard）
- v1.1 — ガチャ演出 & 動画切替、祝福演出、効果音、プレミアムスイッチ

## 今後の改善案

- ガチャ演出のバリエーション追加
- 動画や音声のプリロード・キャッシュ改善
- キーボード操作での完全ハンドリング（スイッチの Space/Enter での操作保証）
- 自動テスト（スコア更新→ガチャ→祝福の統合テスト）

---

詳しい画面操作や設定手順は `操作手順.md` を参照してください。


